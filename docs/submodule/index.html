<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Git TextBook</title>
        <!--SEO--><meta name="title" content="서브모듈" /><!--부트스트랩4-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <style>
            @import url(http://fonts.googleapis.com/earlyaccess/nanumgothic.css);
            body {
                font-family: "Nanum Gothic", sans-serif;
            }
            img {
                max-width:100%;
            }
        </style>
        

    </head>
    <body>
        <!--네비게이션--><!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="/">Git Textbook</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/setup">준비작업
              <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/text">기초탄탄 깃</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/part2">협업하기</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/part3">활용하기</a>
          </li>
        </ul>
      </div>
    </div>
  </nav><nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">setup</li>
              </ol>    
</nav>

<!-- Page Content -->
<div class="container">
    <div class="row">

        <!-- Post Content Column -->
        <div class="col-lg-9">
            <!-- Title -->
            <h1 class="mt-4">서브모듈</h1>
            <hr>

            <p>서브모듈(submodule)은 깃 저장소 안에 또 하나의 서브 저장소를 만들어 사용하는 것을 말합니다.
저장소가 부모의 저장소와 자식의 저장소 2개로 나누어서 운영이 가능합니다.
<br /></p>

<h2 id="실습하기">실습하기</h2>

<p>먼저 저장소 AAA를 하나 만듭니다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd AAA
$ git init 
</code></pre></div></div>
<p><br /></p>

<h2 id="서브모듈-추가">서브모듈 추가</h2>
<p>이미 만들어진 깃저장소에 서브모듈로 자식 저장소를 하나 만들어 봅니다.
서브모듈을 만들쌔 사용하는 명령어는 <code class="highlighter-rouge">submodule</code>입니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git submodule add 저장소주소 폴더명
</code></pre></div></div>
<p>위와 같이 명령을 입력하면 지정한 <code class="highlighter-rouge">폴더명</code>으로 자식 저장소가 하나 추가된 것을 확인할 수 있습니다.</p>

<p>서브모듈을 설치하고 상태를 확인해 보도록 합니다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git status
On branch master
Your branch is up to date with 'origin/master'.

Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

        new file:   .gitmodules
        new file:   aaa
</code></pre></div></div>

<p>위와 같이 서브모듈이 설치된 <code class="highlighter-rouge">디렉토리</code>와 <code class="highlighter-rouge">.gitmodules</code>라는 파일이 생성된 것을 확인할 수 있습니다. <code class="highlighter-rouge">.gitmodules</code>에는 서브모듈들에 대한 정보들을 담고 있습니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat .gitmodules
[submodule "aaa"]
        path = aaa
        url = https://github.com/infohojin/hojin.git

</code></pre></div></div>
<p>파일의 내용을 확인해 보면 위와 같습니다.
<br /></p>

<h2 id="모듈추가-커밋">모듈추가 커밋</h2>
<p>저장소에 서브모듈을 설치후에는 설치되었다는 것을 부모의 깃저장소가 알 수 있도록 커밋작업을 해주어야 합니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git commit -am "add submodule"
[master 4d90a00] add submodule
 2 files changed, 4 insertions(+)
 create mode 100644 .gitmodules
 create mode 160000 aaa

</code></pre></div></div>
<p><br /></p>

<h2 id="부모-저장소에-자식-저장소-추가하여-작업하기">부모 저장소에 자식 저장소 추가하여 작업하기</h2>
<p>자식 저장소에 새로운 파일을 생성해 봅시다. 그리고 부모의 저장소에서 상태를 확인합니다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git status
On branch master
Your branch is ahead of 'origin/master' by 1 commit.
  (use "git push" to publish your local commits)

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

        modified:   aaa (new commits)

no changes added to commit (use "git add" and/or "git commit -a")


</code></pre></div></div>
<p>와 같이 자식 저장소가 변경이 되었다고 상태가 출력이 됩니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> git diff
<span class="gh">diff --git a/aaa b/aaa
index 966b0a4..2657758 160000
</span><span class="gd">--- a/aaa
</span><span class="gi">+++ b/aaa
</span><span class="p">@@ -1 +1 @@</span>
<span class="gd">-Subproject commit 966b0a400f3b030b2882ebd5af300280a139c094
</span><span class="gi">+Subproject commit 2657758d73e90fe3b410a2735189751e0445a678
</span>
</code></pre></div></div>
<p>부모에서는 서브모듈의 저장소를 추적하기 때문에 위와 같이 <code class="highlighter-rouge">git diff</code>명령을 통하여 확인할 수 있습니다.</p>

<p>원격 저장소의 push는 각각 합니다.
자식의 원격 저장소로 push는 자식 저장소로 이동후에 push를 하면 됩니다.</p>

<p>부모 저장소도 push를 하면 됩니다.
<br /></p>

<h2 id="저장소-머지">저장소 머지</h2>
<p>이번에는 자식 저장소에서 작업한 내용을 부모의 저장소에 적용해 보는 실습을 해보도록 합니다.</p>

<p>자식 서브모듈 저장소로 이동합니다. 이동후에 pull을 통하여 리모트에서 자료를 내려 받습니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd child
git pull origin master
</code></pre></div></div>

<p>자식 저장소를 업데이트하였습니다. 자식 저장소가 업데이트로 변경이 되면, 자식저장소가 변경이 되었다는 부모의 깃에게 알려 줍니다.</p>

<p>즉 부모는 자식 서브모듈의 변경내용을 모니터링 하고 있는 것입니다.</p>

<p>변경된 사항을 커밋하고 저장합니다.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git commit -am "update submodule"
</code></pre></div></div>
<p><br /></p>

<h2 id="부모자식-저장소-클론하기">부모/자식 저장소 클론하기</h2>
<p>만일 내가 가지고 있는 저장소가 부모/자식 관계의 서브모듈이 설정된 저장소를 클론할려고 합니다.</p>

<p>서브모듈이 있는 저장소를 클론하게 되면, 서브모듈이 설치되어 있는 저장소의 데이터까지 한번에 가지고 올 수는 없습니다.</p>

<p>서브모듈의 저장소는 존재하지만, 서브모듈의 내용을 가지고 오기 위해서는 초기화와 업데이트 작업을 해주어야 합니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git submodule init
git submodule update
</code></pre></div></div>

<p>서브 모듈을 업데이트 할때 부모 저장소에는 부모 저장소에서 비어있는 서브모듈의 커밋 위치를 자식 저장소의 리모드에서 체크아웃 하여 가지고 오는 역활을 수행합니다.
<br /></p>

<h2 id="서브모듈-업데이트">서브모듈 업데이트</h2>
<p>누군가 서브모듈의 내용을 변경하였습니다. 그리고 변경된 내용을 반형한 부모 저장소도 push를 하였다고 생각해 봅니다.</p>

<p>이런경우 우리는 먼저 부모의 저장소를 pull 하여 갱신을 합니다.
그리고 서브모듈을 같이 업데이트 해야 합니다. 서브모듈 내용까지 자동으로 업데이트 되지는 않습니다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git pull origin master
git submodule update
</code></pre></div></div>
<p><br /></p>

        </div>

        <!-- Sidebar Column -->
        <div class="col-md-3"><!--사이드메뉴1-->
<ul class="list-group">
    <li class="list-group-item list-group-item-dark">Site Menu</li>
    <li class="list-group-item"><a href="/setup">준비작업</a></li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="/text">기초탄탄 깃</a>
        <span class="badge badge-primary badge-pill">10</span>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <a href="/part2">협업하기</a>
        <span class="badge badge-primary badge-pill">5</span>
    </li>
    <li class="list-group-item"><a href="/part3">활용하기</a></li>
</ul>
<br>

<!--사이드메뉴2-->
<ul class="list-group">
    <li class="list-group-item  d-flex justify-content-between align-items-center">
        <a href="/BetaReview">베타리뷰</a>
        <span class="badge badge-primary badge-pill">2</span>
    </li>
    <li class="list-group-item"><a href="/copyright">저작권</a></li>
</ul>

<br></div>

    </div>
    <!-- /.row -->
</div>
<!-- /.container --> <!-- Footer -->
<footer class="py-3 bg-dark">
    <div class="container">
    	<div class="row">
        	<div class="col-lg-12">
				<p class="m-0 text-center text-white">Copyright &copy; jinygit 2020, (주)도서출판</p>
			</div>
			
    	</div>
      
    </div>
    <!-- /.container -->
</footer><!--부트스트랩4-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159909206-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-159909206-1');
        </script>
    </body>

</html>